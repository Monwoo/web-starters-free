{# ðŸŒ–ðŸŒ– Copyright Monwoo 2023 ðŸŒ–ðŸŒ–, build by Miguel Monwoo (service@monwoo.com) #}
{# <link type="text/css" rel="stylesheet" href="{{ asset('pdf-views/sheet.css') }}" > #}
	<style>
{{pdfCssStyles}}
.quotation-item .header {
	background-color: #005B98;
	color: white;
}
.quotation-item .header th {
	border-left: solid 1px white;
	border-right: solid 1px white;
}

.quotation-item .data td {
	border-left: solid 1px black;
	border-right: solid 1px black;
}
</style>
	<style>

.empty-space {
	font-size: 0;
}
</style>

{# 
https://stackoverflow.com/questions/31451779/tcpdf-adding-a-background-to-a-table-cell-or-div-that-shows-on-pdf
Currently, only the following CSS attributes are supported:

font-family
font-weight
font-style
color
background-color
text-decoration
width
height
text-align


	text-align: center; =>  work in style= attr ONLY...

#}

{# DEBUGS colors : #}
{# .empty-space is already defined, if exact same syntax,
will loose previous class definition...
So we add the wildcard 'STAR' to ensure new rules for TCPDF parser
#}
{% set debugColors = false %}
	{% if debugColors %}
		<style>
*.empty-space {
	background-color: #00808F;
}

*.header {
	background-color: #FF0000;
}
*.business-logo {
	background-color: #00FF00;
}
*.quotation-title {
	background-color: #AA0000;
}
*.client-logo {
	background-color: #0000FF;
}

*.contacts .business {
	background-color: #0FF00F;
}
*.contacts .client {
	background-color: #F0F00F;
}

*.thanks {
	background-color: #0AA00A;
}
*.temporality {
	background-color: #A0A00A;
}

*.aim-title {
	background-color: #AF9F30;
}

*.businsess-details {
	background-color: #D1B000;
}
</style>
{% endif %}
{# https://stackoverflow.com/questions/3404095/tcpdf-not-render-all-css-properties
https://stackoverflow.com/questions/19002634/how-to-use-external-css-in-tcpdf-pdf-generation
https://stackoverflow.com/questions/11395171/why-does-tcpdf-ignore-my-inline-css
Some things won't work when included within <style> tags, however they will if added in a style="" attribute in the HTML tag. E.g. table padding â€“ this doesn't work
table {
    padding: 5px;
} 

TCPDF has a very limited CSS support. It doesn't support all attributes.
#}

	{% if billingConfig %}
	{# // TODO: empirique way for now, go check pdf default mesure unit ?... #}
	{% set fullWidth = 539 %}
	{% set pricePerHour = 60 %}
	{% set licenseWpDisplay = 30 %}
	{% set businessLogo = billingConfig.businessLogo ? billingConfig.businessLogo
		: 'file://' ~ kernelRootDir ~ '/public/medias/LogoMonwooDemo.jpeg' %}
	{% set businessWorkloadHours = billingConfig.businessWorkloadHours ?? 6 %}
	{% set businessWorkloadDetails = billingConfig.businessWorkloadDetails
	?? include('pdf-billings/pdf-views/business-item-svelte-workload-details.html.twig',
	{businessWorkloadHours:businessWorkloadHours}) %}
	{% set quotationSeparator = 'file://' ~ kernelRootDir ~ '/public/medias/QuotationSeparator.png' %}
	{% set quotationTotal = licenseWpDisplay + businessWorkloadHours * pricePerHour %}
	{% set quotationStart = billingConfig.quotationStartDay ? billingConfig.quotationStartDay
		: ("now"|date) %}
	{% set quotationEnd = billingConfig.quotationEndDay
	? billingConfig.quotationEndDay : quotationStart | date_modify("+15 day") %}
		<table class="header" style="padding: 0px;border-spacing:{{ (0.3 / 4) * fullWidth }} 0;"> <tr>
			<td class="business-logo" style="width:{{ 0.1 * fullWidth }};">
				<img style="width:{{ 0.1 * fullWidth }};" src="{{ businessLogo }}"/>
			</td>
			<td class="quotation-title" style="width:{{ 0.5 * fullWidth }};text-align: center;
			font-weight:bold;color:#005B98;font-size:14pt;">
				Devis nÂ°{{billingConfig.quotationNumber}}
			</td>
			<td class="client-logo" style="width:{{ 0.1 * fullWidth }};">
				<img style="width:{{ 0.1 * fullWidth }};" src="{{ billingConfig.clientLogoUrl }}"/>
			</td>
		</tr>
	</table>
	<table class="contacts" style="padding: 0px;border-spacing:{{ (0) * fullWidth }} 0;font-size:10pt;">
		<tr>
			<td class="business" style="width:{{ 0.4 * fullWidth }};">
				{% include 'pdf-billings/pdf-views/business-contact.html.twig' with {
            'app': app, 'billingConfig': billingConfig
        } %}
			</td>
			<td class="empty-space" style="width:{{ 0.2 * fullWidth }};
			text-align: center;
			font-weight:bold;color:#005B98;font-size:16pt;
			">
				{{ quotationTotal|format_currency('EUR', {rounding_mode: 'floor'}) }}
				<br/>
				T.T.C.
			</td>
			<td class="client" style="width:{{ 0.4 * fullWidth }};text-align: right;">
				{% include 'pdf-billings/pdf-views/client-contact.html.twig' with {
            'app': app, 'billingConfig': billingConfig
        } %}
			</td>
		</tr>
	</table>
	{# WARNING : height will not work on DIV for tcpdf, but OK INSIDE td fonts on table...
	<div class="empty-space" style="height:30;background-color:red;"></div> #}
	<table class="empty-space" style="font-size:7pt;">
		<tr>
			<td></td>
		</tr>
	</table>

	{% include 'pdf-billings/pdf-views/business-thanks.html.twig' with {
		'app': app, 'billingConfig': billingConfig,
	} %}

	<table class="empty-space" style="font-size:2pt;">
		<tr>
			<td></td>
		</tr>
	</table>

	{% include 'pdf-billings/pdf-views/business-temporality.html.twig' with {
		'app': app, 'billingConfig': billingConfig, 'fullWidth': fullWidth,
		'quotationStart': quotationStart, 'quotationEnd': quotationEnd,
	} %}

	{% include 'pdf-billings/pdf-views/business-aim.html.twig' with {
		'app': app, 'billingConfig': billingConfig, 'fullWidth': fullWidth,
		'quotationStart': quotationStart, 'quotationEnd': quotationEnd,
	} %}

	{% include 'pdf-billings/pdf-views/quotation-item.html.twig' with {
		'app': app, 'billingConfig': billingConfig,
		'description': 'Licence nÃ©cessaires Ã  la production sur 1 nom de domaine de MWS-Svelte-WP-display. Code confidentiel livrÃ© une fois par email ou github.',
		'aimTitle': 'DÃ©tail de licence :',
		'aimTitleBis': 'Monwoo Web Starters <br/>[ Svelte-WP-display ]',
		'aimDescription': include('pdf-billings/pdf-views/business-item-wp-display-details.html.twig'),
		'quantity': 1,
		'pricePerUnitWithoutTaxes': licenseWpDisplay,
		'taxesPercent': 0,
		'discountPercent': 0,
		'priceWithoutTaxes': licenseWpDisplay,
		'priceWithTaxes': licenseWpDisplay,
		'paddingBottom': 1,
	} %}

	<br
	pagebreak="true"/>
	{# // TIPS : will need K_TCPDF_CALLS_IN_HTML to be true to use stuff like : <tcpdf method="AddPage" /> #}

	<table class="empty-space" style="font-size:10;">
		<tr>
			<td></td>
		</tr>
	</table>

	{% include 'pdf-billings/pdf-views/quotation-item.html.twig' with {
		'app': app, 'billingConfig': billingConfig,
		'description': '30 minutes dâ€™expertise Frontend UI Svelte de votre site web en distancielle.',
		'aimTitle': 'Objectif(s) de la prestation :',
		'aimTitleBis': 'Dev Svelte <br/>[ ' ~ businessWorkloadHours|format_number({fraction_digit: 0}) ~ ' heures ]',
		'aimDescription': businessWorkloadDetails,
		'quantity': businessWorkloadHours * 2,
		'pricePerUnitWithoutTaxes': pricePerHour / 2,
		'taxesPercent': 0,
		'discountPercent': 0,
		'priceWithoutTaxes': businessWorkloadHours * pricePerHour,
		'priceWithTaxes': businessWorkloadHours * pricePerHour,
	} %}

	{# TIPS : <div>$nbsp;</div> is MANDATORY here (outside of table ?) for tcpdf, otherwise font-size is not changed 
	and div stay bigger than regular font size if no image inside...
	If using image inside div, set font-size to 0 to avoid extra line height after image in tcpdf
		#}
	<div style="font-size:0px;background-color:#FFD700;">
		<img style="width:{{ 1 * fullWidth }};" src="{{ quotationSeparator }}"/>
	</div>

	{# Simple since no need to handle TVA for micro-BNC status,
	will need to handle TVA and pdf Cert Sign for bigger structures... #}
	{% include 'pdf-billings/pdf-views/quotation-total.html.twig' with {
		'app': app, 'billingConfig': billingConfig,
		'priceWithoutTaxes': quotationTotal,
		'priceWithTaxes': quotationTotal,
	} %}

	{% include 'pdf-billings/pdf-views/quotation-lawful.html.twig' with {
		'app': app, 'billingConfig': billingConfig,
		'quotationNumber': billingConfig.quotationNumber,
	} %}

	<br
	pagebreak="true"/>

	{% include 'pdf-billings/pdf-views/quotation-terms-of-sell.html.twig' with {
		'app': app, 'billingConfig': billingConfig,
		'quotationNumber': billingConfig.quotationNumber,
	} %}

{% else %}
	Please, submit previous form to update this PDF.
{% endif %}
