{# ðŸŒ–ðŸŒ– Copyright Monwoo 2023 ðŸŒ–ðŸŒ–, build by Miguel Monwoo (service@monwoo.com) #}
{% set route = app.request.attributes.get('_route') %}
<!DOCTYPE html>
<html lang="fr">
	<head>
		<meta charset="UTF-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<!-- plz dont cache this page -->
		<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
		<meta http-equiv="Pragma" content="no-cache">
		<meta http-equiv="Expires" content="0">
		<title>
      {% block title %}
        {{ title ?? "" }}
      {% endblock %}
		</title>
		{% block stylesheets %}
			{{ encore_entry_link_tags('mwsMoonManager') }}
			{{ encore_entry_link_tags('app') }}
		{% endblock %}
	</head>

	<body>
		{% block storesInit %}
			<div
			class="hidden"
			{{ svelte_component('MwsReduxSync', {
				'stateUpdate': {
					'packageName': packageName,
					'packageVersion': packageVersion,
				}|serialize('json')|e('html_attr'),
			}) }}></div>
		{% endblock %}

		{% block body %}
		  <div class="flex flex-col h-screen overflow-hidden">
				{% block header %}
					{# // TODO : pre-rendering system instead of hard coded UI sync ? #}
					<header class="py-5 bg-gray-700 text-white text-center"
					{{ svelte_component('MwsHeader', {

					}) }}>
						Sticky Header and Footer with Tailwind
					</header>
				{% endblock %}
		    <main class="flex-1 overflow-y-auto p-5">
					{% block content %}
						{# DEFAULT content view #}
						{% if app.user %}
							<a href="{{ path('mws_user_logout') }}">
								<u>Logout from
									{{ app.user.username }}</u>
							</a>
						{% endif %}
						<div class="example-wrapper">
							<h1>{{ block('title') }}! âœ…</h1>
						</div>
					{% endblock %}
				</main>
				{% block footer %}
					<footer
					class="py-5 bg-gray-700 text-gray-300 text-center overflow-hidden"
					{{ svelte_component('MwsFooter', {
						'copyright': 'mws.copyright'|trans({}, 'mws-moon-manager'),
						'packageName': packageName,
						'packageVersion': packageVersion,
					}) }}>
						{# // For SEO, will be replaced by js...
						// TODO : prefill with some pre-rendering of js controller
						//  at assets 'watch' and/or 'build' phase #}
						<p>
						  <a href="https://www.monwoo.com" target="_blank" rel="noopener">
								{{'mws.copyright'|trans({}, 'mws-moon-manager')}}
							</a>
						</p>
						<p class="text-right px-3 text-gray-400">[ {{packageName}} v-{{packageVersion}} ]</p>
					</footer>
				{% endblock %}
			</div>
		{% endblock %}

		{% block javascript %}
			<script>
				window.baseHref = "{{ app.request.getBaseURL()|e('js') }}";
				window.mwsTchatUpTok = "{{ csrf_token('mws-csrf-message-tchat-upload') }}";
			</script>
			{# TOO early for stimulus controler ? <script src="{{ path('fos_js_routing_js', { callback: 'fos.Router.setData' }) }}"></script> #}
			{# WARNING : order counts for routes loads, manually done inside mwsMoonManager for now #}

			{# TODO : inject inside app.js... instead of html loads... # }
			<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
		  <script type="text/javascript" src="https://unpkg.com/survey-jquery@1.9.125/survey.jquery.js"></script>
			{ # #}
			<script type="text/javascript" src="{{ asset('bundles/moonmanager/lib/jquery.3.7.1.min.js') }}"></script>
		  <script type="text/javascript" src="{{ asset('bundles/moonmanager/lib/survey-jquery.1.9.112.min.js') }}"></script>
			{# <script type="text/javascript" src="https://unpkg.com/survey-jquery@1.9.125/survey.jquery.js"></script>#}


	    {{ encore_entry_script_tags('mwsMoonManager') }}
	    {{ encore_entry_script_tags('app') }}
			{# TOO late for stimulus controler ? <script src="{{ path('fos_js_routing_js', { callback: 'fos.Router.setData' }) }}"></script> #}

			{# {% if app.request.attributes.get('_route') in ['app_pdf_billings'] %}
        <!-- (or extend javascript block in specific child view/base...) -->
				<script src="{{ asset('libs/pdfjs-3.7.107/pdf.js') }}"></script>
			{% endif %} #}
		{% endblock %}
	</body>
</html>
