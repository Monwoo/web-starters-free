{# ðŸŒ–ðŸŒ– Copyright Monwoo 2023 ðŸŒ–ðŸŒ–, build by Miguel Monwoo (service@monwoo.com) #}
{% set model = {
    description: "Ajouter"|trans,
    fitToContainer: true,
    "__CMT_TIPS": "Will validate form on searchKeyword enter key with goNextPageAutomatic",
    '__goNextPageAutomatic': true,
    completeText: {
        en: "Save message",
        fr: "Enregistrer le message"
    },
    "__CMT__showPrevButton": true,
    focusFirstQuestionAutomatic: false,
    showQuestionNumbers: false,
    elements: [{
            name: "templatePreload",
            title: "PrÃ© charger avec le template",
            type: "dropdown",
            showNoneItem: true,
            showOtherItem: true,
            "_cmt":"https://surveyjs.io/form-library/examples/dropdown-box-with-custom-items/reactjs#content-code",
            "_itemComponent": "new-item",
            "_choices": { "hello" : ["Ford", "Vauxhall", "Volkswagen"], world: ["Nissan", "Audi", "Mercedes-Benz", "BMW", "Peugeot", "Toyota", "Citroen"] },
            "choices": [ "Ford", "Vauxhall", "Volkswagen", "Nissan", "Audi", "Mercedes-Benz", "BMW", "Peugeot", "Toyota", "Citroen" ],
            "searchEnabled":  false,
            validators: [],
            minWidth: "20%",
            isRequired: false,
        }, {
            name: "projectId",
            title: "projectId",
            type: "text",
            "_cmt": "limited to 200 chars : ",
            maxLength: 200,
            validators: [],
            minWidth: "20%",
            isRequired: false,
        }, {
            name: "destId",
            title: "destId",
            type: "text",
            "_cmt": "limited to 200 chars : ",
            maxLength: 200,
            validators: [],
            minWidth: "20%",
            isRequired: true,
        }, {
            name: "monwooAmount",
            title: "monwooAmount",
            type: "text",
            inputType: "number",
            "_cmt": "limited to 200 chars : ",
            maxLength: 200,
            validators: [],
            minWidth: "20%",
            isRequired: false,
        }, {
            name: "projectDelayInOpenDays",
            title: "projectDelayInOpenDays",
            type: "text",
            inputType: "number",
            "_cmt": "limited to 200 chars : ",
            maxLength: 200,
            validators: [],
            minWidth: "20%",
            isRequired: false,
        }, {
            name: "asNewOffer",
            title: "asNewOffer",
            type: "boolean",
            "description": "En tant que nouveau message.",
            "valueTrue": true,
            "valueFalse": false,
            "_cmt": "limited to 200 chars : ",
            validators: [],
            minWidth: "20%",
            isRequired: false,
        }, {
            startWithNewLine: false,
            name: "isDraft",
            title: "isDraft",
            type: "boolean",
            "description": "Brouillon, attendre avant d'envoyer.",
            validators: [],
            minWidth: "20%",
            isRequired: false,
        }, {
            startWithNewLine: false,
            name: "isTemplate",
            title: "Is template",
            type: "boolean",
            "description": "Utiliser en tant que template.",
            validators: [],
            minWidth: "20%",
            isRequired: false,
        }, {
            name: "templateNameSlug",
            visibleIf: "{isTemplate}",
            title: "templateNameSlug",
            type: "text",
            "_cmt": "limited to 200 chars : ",
            maxLength: 200,
            validators: [],
            minWidth: "20%",
            isRequired: true,
        }, {
            name: "templateCategorySlug",
            visibleIf: "{isTemplate}",
            title: "templateCategorySlug",
            type: "text",
            "_cmt": "limited to 200 chars : ",
            maxLength: 200,
            validators: [],
            minWidth: "20%",
            isRequired: true,
        }, {
            name: "sourceId",
            title: "sourceId",
            type: "text",
            "_cmt": "limited to 200 chars : ",
            maxLength: 200,
            validators: [],
            minWidth: "20%",
            isRequired: false,
        }, {
            "type": "paneldynamic",
            "minPanelCount": 0,
            "name": "messages",
            "valueName": "messages",
            "title": "Add tchat message to send on next bulks sync :",
            "panelAddText": "Add tchat",
            "panelCount": 0,
            "templateElements": [
                {
                    "type": "file",
                    "title": "Attach file if you want (max 1Mo)",
                    "name": "uploadFile",
                    "storeDataAsText": false,
                    "waitForUpload": true,
                    "allowMultiple": false,
                    "maxSize": 1024000,
                    "hideNumber": true
                }, {
                    visibleIf: "{panel.uploadFile.0.content} != ''",
                    startWithNewLine: false,
                    type: "html",
                    html: "Fichier joint : <a href='{panel.uploadFile.0.content}' target='_blank'>{panel.uploadFile.0.name}</a>",
                },  {
                    visibleIf: "{panel.uploadFile.0.content} != ''",
                    startWithNewLine: false,
                    name: "deleteUpload",
                    title: "Supprimer ",
                    type: "boolean",
                    "description": "Enlever la piÃ¨ce jointe.",
                    validators: [],
                    minWidth: "20%",
                    isRequired: false,
                }, {
                    name: "text",
                    title: "Texte",
                    type: "comment",
                    "_cmt": "limited to 1000 chars : ",
                    maxLength: 1000,
                    validators: [],
                    minWidth: "20%",
                    '_cmt2': "Nb of lines in textarea :",
                    rows: 21,
                    isRequired: false,
                }
            ]
        }, {
            startWithNewLine: true,
            name: "shouldDeleteMessage",
            title: "Supprimer ce message",
            type: "boolean",
            "description": "Supprimer ce message de la base de donnÃ©es.",
            validators: [],
            minWidth: "20%",
            isRequired: false,
        },
    ]
} %}
{{ model|serialize('json')|raw }}

{#
TODO : can't show alert with json data model only ? :
https://surveyjs.answerdesk.io/ticket/details/t11430/how-can-i-show-a-confirmation-popup-on-changing-a-value-in-the-form
survey.onValueChanging.add(function(sender, options){
   if(confirm('Your name is: ' + options.value)){
     alert('The name is successfully updated');
   } else {
     options.value = options.oldValue;
   }
});
#}

{# 
// TODO : migrate back to full js side config file, will be better for syntax checks, comments, {% endswitch %}
//        x-state base ?
{
                "_cmt2": "For informational purpose in sync with data model, will upload other way :",
                enableIf: "false",
                name: "attachementFileKeyPath",
                title: "attachementFileKeyPath",
                type: "text",
                "_cmt": "limited to 200 chars : // TODO : ok for URL ? ",
                maxLength: 200,
                validators: [],
                minWidth: "20%",
                isRequired: false,
            }, {
                "_cmt2": "For informational purpose in sync with data model, will upload other way :",
                _enableIf: "{panel.attachementFileKeyPath} <> ''",
                enableIf: "false",
                startWithNewLine: false,
                name: "uploadFilePath",
                title: "uploadFilePath",
                type: "text",
                "_cmt": "limited to 200 chars : // TODO : ok for URL ? ",
                maxLength: 200,
                validators: [],
                minWidth: "20%",
                isRequired: false,
            }, {
                visibleIf: "false",
                startWithNewLine: false,
                type: "html",
                html: "displayValue( {row.attachementFileKeyPath} | displayValue({panel.attachementFileKeyPath}) | {panel.attachementFileKeyPath} | {displayValue(isTemplate)})",
            }, #}
