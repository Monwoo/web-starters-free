{# ðŸŒ–ðŸŒ– Copyright Monwoo 2023 ðŸŒ–ðŸŒ–, build by Miguel Monwoo (service@monwoo.com) #}
{% set model = {
    description: "Ajouter"|trans,
    fitToContainer: true,
    "__CMT_TIPS": "Will validate form on searchKeyword enter key with goNextPageAutomatic",
    '__goNextPageAutomatic': true,
    completeText: {
        en: "Save offer",
        fr: "Enregistrer l'offre"
    },
    "__CMT__showPrevButton": true,
    focusFirstQuestionAutomatic: false,
    showQuestionNumbers: false,
    elements: [{
            name: "sourceName",
            title: "Nom de la source",
            type: "text",
            "_cmt": "limited to 255 chars : ",
            maxLength: 255,
            validators: [],
            minWidth: "20%",
            isRequired: false,
        },{
            name: "clientUsername",
            title: "Nom du client",
            type: "text",
            "_cmt": "limited to 255 chars : ",
            maxLength: 255,
            validators: [],
            minWidth: "20%",
            isRequired: false,
            startWithNewLine: false,
        }, {
            name: "contact1",
            title: "Contact (1)",
            type: "text",
            "_cmt": "limited to 255 chars : ",
            maxLength: 255,
            validators: [],
            minWidth: "20%",
            isRequired: false,
        }, {
            name: "contact2",
            title: "Contact (2)",
            type: "text",
            "_cmt": "limited to 255 chars : ",
            maxLength: 255,
            validators: [],
            minWidth: "20%",
            isRequired: false,
            startWithNewLine: false,
        }, {
            name: "contact3",
            title: "Contact (3)",
            type: "text",
            "_cmt": "limited to 255 chars : ",
            maxLength: 255,
            validators: [],
            minWidth: "20%",
            isRequired: false,
            startWithNewLine: false,
        },{
            name: "sourceUrl",
            title: "Source (URL)",
            type: "comment",
            "_cmt": "limited to 255 chars : ",
            validators: [],
            rows: 1,
            minWidth: "20%",
            isRequired: false,
        },{
            name: "clientUrl",
            title: "Client (URL)",
            type: "comment",
            "_cmt": "limited to 255 chars : ",
            validators: [],
            rows: 1,
            minWidth: "20%",
            isRequired: false,
            startWithNewLine: false,
        }, {
            name: "currentBillingNumber",
            title: "Dernier numÃ©ro de facturation",
            type: "text",
            "_cmt": "limited to 255 chars : ",
            maxLength: 255,
            validators: [],
            minWidth: "20%",
            isRequired: false,
            startWithNewLine: false,
        }, {
            name: "currentStatusSlug",
            title: "Dernier statut",
            description: "Slug du dernier status",
            type: "tagbox",
            validators: [],
            minWidth: "20%",
            isRequired: false,
            choices: allOfferTags,
        }, {
            "type": "paneldynamic",
            "minPanelCount": 0,
            "name": "contacts",
            "valueName": "contacts",
            "title": "Ajouter un contact :",
            "panelAddText": "Add contact",
            "panelCount": 0,
            "templateElements": [
                {
                    name: "sourceName",
                    title: "Nom de la source",
                    type: "text",
                    "_cmt": "limited to 255 chars : ",
                    maxLength: 255,
                    validators: [],
                    minWidth: "20%",
                    isRequired: false,
                },{
                    name: "username",
                    title: "Nom du contact",
                    type: "text",
                    "_cmt": "limited to 255 chars : ",
                    maxLength: 255,
                    validators: [],
                    minWidth: "20%",
                    isRequired: false,
                    startWithNewLine: false,
                },{
                    name: "email",
                    title: "Email",
                    type: "text",
                    "_cmt": "limited to 255 chars : ",
                    maxLength: 255,
                    validators: [],
                    minWidth: "20%",
                    isRequired: false,
                },{
                    name: "phone",
                    title: "TÃ©lÃ©phone",
                    type: "text",
                    "_cmt": "limited to 255 chars : ",
                    maxLength: 255,
                    validators: [],
                    minWidth: "20%",
                    isRequired: false,
                    startWithNewLine: false,
                },{
                    name: "status",
                    title: "Statut du contact (description)",
                    type: "comment",
                    "_cmt": "limited to 1000 chars : ",
                    maxLength: 1000,
                    '_cmt2': "Nb of lines in textarea :",
                    rows: 2,
                    validators: [],
                    minWidth: "20%",
                    isRequired: false,
                },{
                    name: "postalCode",
                    title: "Code Postal",
                    type: "text",
                    "_cmt": "limited to 255 chars : ",
                    maxLength: 255,
                    validators: [],
                    minWidth: "20%",
                    startWithNewLine: true,
                    isRequired: false,
                },{
                    name: "city",
                    title: "Ville",
                    type: "text",
                    "_cmt": "limited to 255 chars : ",
                    maxLength: 255,
                    validators: [],
                    startWithNewLine: false,
                    minWidth: "20%",
                    isRequired: false,
                },{
                    name: "avatarUrl",
                    title: "Avatar (URL)",
                    type: "comment",
                    "_cmt": "limited to 255 chars : ",
                    validators: [],
                    rows: 1,
                    minWidth: "20%",
                    isRequired: false,
                },{
                    name: "businessUrl",
                    title: "Business (URL)",
                    type: "comment",
                    "_cmt": "limited to 255 chars : ",
                    validators: [],
                    rows: 1,
                    minWidth: "20%",
                    isRequired: false,
                }
            ]
        }, {
            "type": "paneldynamic",
            "minPanelCount": 1,
            "maxPanelCount": 1,
            "name": "sourceDetail",
            "title": "DÃ©tail de la source :",
            "state": "expanded",
            "templateElements": [
                {
                    name: "description",
                    title: "Description de l'offre",
                    type: "comment",
                    '_cmt2': "Nb of lines in textarea :",
                    rows: 12,
                    validators: [],
                    minWidth: "20%",
                    isRequired: false,
                }, {
                    "_cmt": "https://surveyjs.io/stay-updated/blog/how-to-use-text-piping-in-surveys",
                    "_cmt2": "https://surveyjs.io/form-library/examples/aggregate-data-within-form/reactjs",
                    "type": "paneldynamic",
                    "minPanelCount": 0,
                    "name": "messages",
                    "title": "Ajouter un message :",
                    "panelAddText": "Nouveau message",
                    "panelCount": 0,
                    "templateElements": [
                        {
                            name: "msg",
                            title: "Text html",
                            type: "comment",
                            '_cmt2': "Nb of lines in textarea :",
                            rows: 12,
                            validators: [],
                            minWidth: "20%",
                            isRequired: false,
                        },
                    ],
                }
            ]
        }, {
            startWithNewLine: true,
            name: "shouldDeleteOffer",
            title: "Supprimer cette offre",
            visibleIf: "{id} != ''",
            type: "boolean",
            "description": "Supprimer cette offre de la base de donnÃ©es.",
            validators: [],
            minWidth: "20%",
            isRequired: false,
        },
    ]
} %}
{{ model|serialize('json')|raw }}

{# 
                , {
                    visibleIf: "{panel.uploadFile.0.content} != ''",
                    startWithNewLine: false,
                    type: "html",
                    html: "Fichier joint : <a href='{panel.uploadFile.0.content}' target='_blank'>{panel.uploadFile.0.name}</a>",
                }, {
                    visibleIf: "{panel.uploadFile.0.content} != ''",
                    startWithNewLine: false,
                    name: "deleteUpload",
                    title: "Supprimer ",
                    type: "boolean",
                    "description": "Enlever la piÃ¨ce jointe.",
                    validators: [],
                    minWidth: "20%",
                    isRequired: false,
                }, 
 #}

{#
TODO : can't show alert with json data model only ? :
https://surveyjs.answerdesk.io/ticket/details/t11430/how-can-i-show-a-confirmation-popup-on-changing-a-value-in-the-form
survey.onValueChanging.add(function(sender, options){
   if(confirm('Your name is: ' + options.value)){
     alert('The name is successfully updated');
   } else {
     options.value = options.oldValue;
   }
});
#}

{# 
// TODO : migrate back to full js side config file, will be better for syntax checks, comments, {% endswitch %}
//        x-state base ?
{
                "_cmt2": "For informational purpose in sync with data model, will upload other way :",
                enableIf: "false",
                name: "attachementFileKeyPath",
                title: "attachementFileKeyPath",
                type: "text",
                "_cmt": "limited to 200 chars : // TODO : ok for URL ? ",
                maxLength: 200,
                validators: [],
                minWidth: "20%",
                isRequired: false,
            }, {
                "_cmt2": "For informational purpose in sync with data model, will upload other way :",
                _enableIf: "{panel.attachementFileKeyPath} <> ''",
                enableIf: "false",
                startWithNewLine: false,
                name: "uploadFilePath",
                title: "uploadFilePath",
                type: "text",
                "_cmt": "limited to 200 chars : // TODO : ok for URL ? ",
                maxLength: 200,
                validators: [],
                minWidth: "20%",
                isRequired: false,
            }, {
                visibleIf: "false",
                startWithNewLine: false,
                type: "html",
                html: "displayValue( {row.attachementFileKeyPath} | displayValue({panel.attachementFileKeyPath}) | {panel.attachementFileKeyPath} | {displayValue(isTemplate)})",
            }, #}
